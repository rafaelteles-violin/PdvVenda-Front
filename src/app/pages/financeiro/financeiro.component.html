<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<div class="container my-4">

  <!-- BOTÃO VOLTAR -->
  <div class="d-flex mb-4">
    <button class="btn btn-secondary d-flex align-items-center gap-2 shadow-sm" (click)="voltar()">
      <i class="material-icons">arrow_back</i> Voltar
    </button>
  </div>

  <!-- FILTRO DE DATAS -->
  <div class="card mb-4 shadow-sm">
    <div class="card-body">
      <h5 class="card-title mb-3">
        <i class="material-icons text-primary me-2">filter_alt</i> Filtrar por Data
      </h5>

      <!-- LINHA DO FILTRO CENTRALIZADA -->
      <div class="d-flex filtro-datas">
        <mat-form-field appearance="outline" style="width: 180px;">
          <mat-label>Data Início</mat-label>
          <input matInput [matDatepicker]="pickerInicio" [(ngModel)]="dataInicio" placeholder="Selecione a data" />
          <mat-datepicker-toggle matSuffix [for]="pickerInicio"></mat-datepicker-toggle>
          <mat-datepicker #pickerInicio></mat-datepicker>
        </mat-form-field>

        <mat-form-field appearance="outline" style="width: 180px;">
          <mat-label>Data Fim</mat-label>
          <input matInput [matDatepicker]="pickerFim" [(ngModel)]="dataFim" placeholder="Selecione a data" />
          <mat-datepicker-toggle matSuffix [for]="pickerFim"></mat-datepicker-toggle>
          <mat-datepicker #pickerFim></mat-datepicker>
        </mat-form-field>

        <button class="btn btn-primary btn-alinhado" 
        (click)="filtrarPorData()"  [disabled]="isLoading">
          <i class="material-icons">filter_alt</i>
          {{ isLoading ? 'Filtrando...' : 'Filtrar' }} 
        </button>
      </div>
    </div>
  </div>

  <!-- CARDS DE RESUMO -->
  <div class="card-resumo">
    <div class="col-md-6">
      <div class="card summary-card shadow-sm">
        <div class="card-body text-center">
          <i class="material-icons text-primary fs-2">shopping_cart</i>
          <h5 class="mt-2">Total de Vendas</h5>
          <h3 class="fw-bold">{{ vendas.totalDeVenda }}</h3>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="card summary-card shadow-sm">
        <div class="card-body text-center">
          <i class="material-icons text-success fs-2">payments</i>
          <h5 class="mt-2">Total Faturamento</h5>
          <h3 class="fw-bold">{{ vendas.totalFaturamento }}</h3>
        </div>
      </div>
    </div>
  </div>

  <!-- TABELA DE VENDAS -->
  <div class="card shadow-sm">
    <div class="card-header bg-primary text-white fw-semibold text-center">
      VENDAS REALIZADAS
    </div>
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-striped mb-0">
          <thead class="table-light">
            <tr>
              <th>Data</th>
              <th>Detalhes</th>
              <th>Pagamento</th>
              <th>Valor Total</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let venda of vendas.vendaDtos">
              <td>{{ venda.dataVenda }}</td>
              <td>
                <summary class="text-primary">produtos</summary>
                <ul class="list-unstyled ms-3 mt-2">
                  <li *ngFor="let detalhe of venda.vendaDetalhe">
                    {{ detalhe.nomeProduto }} - {{detalhe.precoUnitario}} - {{ detalhe.quantidade }} un.
                  </li>
                </ul>
              </td>
              <td>{{ venda.formaDePagamento }}</td>
              <td>{{ venda.valorTotal }}</td>
            </tr>
          </tbody>
        </table>
      </div> 
    </div>
  </div>

  <!-- TABELA POR PRODUTOS -->
  <div class="card shadow-sm">
    <div class="card-header bg-primary text-white fw-semibold text-center">
      QUANTIDADE VENDIDA
    </div>
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-striped mb-0">
          <thead class="table-light">
            <tr>
              <th>Produto</th>
              <th>Quantidade</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let venda of vendas.vendaProdutos">
              <td>{{ venda.nomeProduto }}</td>
              <td>{{ venda.quantidade }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

</div>
